<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>高斯混合模型 - Hello, world! I'm Gxxang Liu</title>

  <!-- Edit site and author settings in `_config.yml` to make the social details your own -->

    <meta content="Hello, world! I'm Gxxang Liu" property="og:site_name">
  
    <meta content="高斯混合模型" property="og:title">
  
  
    <meta content="article" property="og:type">
  
  
    <meta content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.
" property="og:description">
  
  
    <meta content="http://0.0.0.0:4000/drafts/gmm/" property="og:url">
  
  
    <meta content="2019-08-03T00:00:00+08:00" property="article:published_time">
    <meta content="http://0.0.0.0:4000/about/" property="article:author">
  
  
    <meta content="http://0.0.0.0:4000/flexible-jekyll/assets/img/avatar.png" property="og:image">
  
  
  
    
    <meta content="ML" property="article:tag">
    
    <meta content="GMM" property="article:tag">
    
  

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@">
    <meta name="twitter:creator" content="@">
  
    <meta name="twitter:title" content="高斯混合模型">
  
  
    <meta name="twitter:url" content="http://0.0.0.0:4000/drafts/gmm/">
  
  
    <meta name="twitter:description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.
">
  
  
    <meta name="twitter:image:src" content="http://0.0.0.0:4000/flexible-jekyll/assets/img/avatar.png">
  

	<meta name="description" content="">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta property="og:image" content="">
	<link rel="shortcut icon" href="/flexible-jekyll/assets/img/favicon/favicon.ico" type="image/x-icon">
	<link rel="apple-touch-icon" href="/flexible-jekyll/assets/img/favicon/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/flexible-jekyll/assets/img/favicon/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="144x144" href="/flexible-jekyll/assets/img/favicon/apple-touch-icon-144x144.png">
	<!-- Chrome, Firefox OS and Opera -->
	<meta name="theme-color" content="#263959">
	<!-- Windows Phone -->
	<meta name="msapplication-navbutton-color" content="#263959">
	<!-- iOS Safari -->
	<meta name="apple-mobile-web-app-status-bar-style" content="#263959">
	<!-- Google Fonts -->
	<link href="https://fonts.googleapis.com/css?family=PT+Serif:400,700" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet">
	<!-- Font Awesome -->
	<link rel="stylesheet" href="/flexible-jekyll/assets/fonts/font-awesome/css/font-awesome.min.css">
	<!-- Styles -->
	<link rel="stylesheet" href="/flexible-jekyll/assets/css/main.css">
</head>

<body>

  <div class="wrapper">
    <aside class="sidebar">
  <header>
    <div class="about">
      <div class="cover-author-image">
        <a href="/flexible-jekyll/"><img src="/flexible-jekyll/assets/img/avatar.png" alt="Gaoang Liu"></a>
      </div>
      <div class="author-name">Gaoang Liu</div>
      <p>I am machine-learning lover focusing on Deep Learning. Always hungry to keep learning.</p>
    </div>
  </header> <!-- End Header -->
  <footer>
    <section class="contact">
      <h3 class="contact-title">Contact me</h3>
      <ul>
        <!-- 
          <li><a href="https://twitter.com/artemsheludko_" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a></li>
        
        
          <li><a href="https://facebook.com/" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a></li>
         -->
        
          <li class="github"><a href="http://github.com/ssrzz" target="_blank"><i class="fa fa-github"></i></a></li>
        
        <!-- 
          <li class="linkedin"><a href="https://in.linkedin.com/" target="_blank"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li>
         -->
        
          <li class="email"><a href="mailto:ssrzz@pm.me"><i class="fa fa-envelope-o"></i></a></li>
        
      </ul>
    </section> <!-- End Section Contact -->
    <div class="copyright">
      <p>2019 &copy; Gaoang Liu</p>
    </div>
  </footer> <!-- End Footer -->
</aside> <!-- End Sidebar -->
<div class="content-box clearfix">
  <script type="text/javascript" async src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


<article class="article-page">
  <div class="page-content">
    
    
    <div class="wrap-content">
      <header class="header-page">
        <h1 class="page-title">高斯混合模型</h1>
        <div class="page-date"><span>2019, Aug 03&nbsp;&nbsp;&nbsp;&nbsp;</span></div>
      </header>
      <h1 id="gaussian">Gaussian</h1>

<p>高斯混合模型(Gaussian Mixture Model, abbr. GMM)是一个假设所有的数据点都是生成于有限个带有未知参数的高斯分布所混合的概率模型，即多个高斯分布函数的线性组合。理论上GMM可以拟合出任意类型的分布，通常用于解决同一集合下的数据包含多个不同的分布的情况（或者是同一类分布但参数不一样，或者是不同类型的分布，比如正态分布和伯努利分布）。</p>

<p>GMM可以看作是 k-means 聚类算法的一种扩展使用 。</p>

<h1 id="model-formula">Model Formula</h1>

<p>假设随机变量为<script type="math/tex">X</script> ,那么GMM可以表示为：</p>

<script type="math/tex; mode=display">p(x) = \sum\limits_{k=1}^K \pi_k \mathcal{N}(x|\mu_k, \sigma_k)</script>

<p>其中<script type="math/tex">\mathcal{N}(x\mid\mu_k, \sigma_k)</script> 为混合模型中的第<script type="math/tex">k</script>个<strong>分量(component)</strong>； <script type="math/tex">\pi_k</script>为<strong>混合系数(mixture coefficient)</strong> s.t. <script type="math/tex">\sum\limits_{k=1}^K \pi_k = 1</script>，也可以认为是第<script type="math/tex">k</script>个分量的权重。</p>

<h1 id="应用">应用</h1>

<p>将GMM用于聚类时，假设数据服从混合高斯分布（Mixture Gaussian Distribution），那么只要根据数据推出 GMM 的概率分布来即可。</p>

<p>GMM 的 $K$ 个分量实际上对应$K$个<strong>簇(cluster)</strong> 。根据数据来推算概率密度通常被称作 density estimation 。特别地，当我已知（或假定）概率密度函数的形式，而要估计其中的参数的过程被称作<strong>参数估计</strong>。</p>

<h2 id="参数估计">参数估计</h2>

<p>当存在$K$个聚类，公式<script type="math/tex">p(x) = \sum\limits_{k=1}^K \pi_k \mathcal{N}(x\mid\mu_k, \sigma_k)</script>中存在 <script type="math/tex">3K</script> 个未知参数 <script type="math/tex">\{\pi_k, \mu_k, \sigma_k\mid k \in [1..K]\}</script>。如何估算这些参数 ？Short answer:  <strong>最大似然估计</strong>。</p>

<p>@TODO</p>

<h2 id="在kaggle练手比赛中的应用">在Kaggle(练手)比赛中的应用</h2>

<p><a href="https://www.kaggle.com/c/data-science-london-scikit-learn/">Data-Science-londo-scikit-learn</a> 给出一个简单的训练集(1000 x 40)，存在40个特征，要求对9000个测试样本进行预测。使用简单的KNN/RandomForest算法，通过网格搜索最佳参数，最终预测结果：0.89828</p>

<p>而采用GMM对数据进行处理后，再使用KNN/随机森林，预测结果可达：0.99143 （前20名的水平）</p>

<h2 id="sklearn--gmm">Sklearn &amp; GMM</h2>

<p><code class="highlighter-rouge">sklearn.mixture</code> 是一个应用高斯混合模型进行非监督学习的包，支持<strong>diagonal，spherical，tied，full</strong>四种协方差矩阵 (diagonal指每个分量分布有各自不同对角协方差矩阵，spherical指每个分量分布有各自不同的简单协方差矩阵， tied指所有分量分布有相同的标准协方差矩阵，full指每个分量分布有各自不同的标准协方差矩阵） ，它对数据进行抽样，并且根据数据估计模型。同时包也提供了相关支持，来帮助用户决定合适的分量分布个数。</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span><span class="p">;</span> <span class="n">sns</span><span class="o">.</span><span class="nb">set</span><span class="p">()</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets.samples_generator</span> <span class="kn">import</span> <span class="n">make_blobs</span>
<span class="c1"># Produce experiment data, 4 clusters
</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">cluster_std</span><span class="o">=</span><span class="mf">0.60</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.mixture</span> <span class="kn">import</span> <span class="n">GaussianMixture</span>
<span class="n">gmm</span> <span class="o">=</span> <span class="n">GaussianMixture</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">gmm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'viridis'</span><span class="p">)</span>
</code></pre></div></div>

<p>聚类图示</p>

<p><img src="/img/gmm.png" alt="image" /></p>

<p>sklearn.GaussianMixture有一个<code class="highlighter-rouge">predict_proba(X)</code>方法，可以求出混合系统<script type="math/tex">\pi_k</script>。 方法方法返回一个大小为<script type="math/tex">[n_\text{samples}, n_\text{clusters}]</script>的矩阵，矩阵会给出任意属于某个簇的概率。接上例</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">probs</span> <span class="o">=</span> <span class="n">gmm</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">probs</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="nb">round</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</code></pre></div></div>

<p>得出结果</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[[</span>0.531 0.    0.469 0.   <span class="o">]</span>
 <span class="o">[</span>0.    0.    0.    1.   <span class="o">]</span>
 <span class="o">[</span>0.    0.    0.    1.   <span class="o">]</span>
 <span class="o">[</span>1.    0.    0.    0.   <span class="o">]</span>
 <span class="o">[</span>0.    0.    0.    1.   <span class="o">]]</span>
</code></pre></div></div>

<p>GMM模型中的超参数<code class="highlighter-rouge">convariance_type</code>控制这每个簇的形状自由度。</p>

<ul>
  <li>默认 convariance_type=’diag’, 意思是簇在每个维度的尺寸都可以单独设置，但椭圆边界的主轴要与坐标轴平行；</li>
  <li>covariance_type=’spherical’ 时模型通过约束簇的形状，让所有维度相等。这样得到的聚类结果和k-means聚类的特征是相似的，虽然两者并不完全相同。</li>
  <li>covariance_type=’full’时，该模型允许每个簇在任意方向上用椭圆建模。</li>
</ul>

<p>GMM提供了一种确定数据集最优成分数量的方法。由于生成模型本身就是数据集的概率分布，因此可以利用模型来评估数据的似然估计，并利用交叉检验防止过拟合。Scikit-Learn的GMM评估器内置了两种纠正过拟合的标准分析方法：赤池信息量准则（AIC）和BIC（Bayesian Information Criterion，贝叶斯信息准则）</p>

<h1 id="参考文献">参考文献</h1>

<ol>
  <li><a href="https://sklearn.apachecn.org/docs/0.21.3/20.html">Scikit-Learn中文文档</a>, ApacheCN</li>
  <li><a href="https://blog.csdn.net/jinping_shi/article/details/59613054">高斯混合模型（GMM）及其EM算法的理解</a>，阿拉丁吃米粉，CSDN blog</li>
  <li><a href="https://blog.csdn.net/jasonzhoujx/article/details/81947663">高斯混合模型(GMM)应用：分类、密度估计、生成模型</a>，盐味橙汁，CSDN blog， 2018-08</li>
</ol>


      <div class="page-footer">
        <div class="page-share">
          <a href="https://twitter.com/intent/tweet?text=高斯混合模型&url=http://0.0.0.0:4000/drafts/gmm/" title="Share on Twitter" rel="nofollow" target="_blank">Twitter</a>
          <a href="https://facebook.com/sharer.php?u=http://0.0.0.0:4000/drafts/gmm/" title="Share on Facebook" rel="nofollow" target="_blank">Facebook</a>
          <a href="https://plus.google.com/share?url=http://0.0.0.0:4000/drafts/gmm/" title="Share on Google+" rel="nofollow" target="_blank">Google+</a>
        </div>
        <div class="page-tag">
          
            <a href="/flexible-jekyll/tags#ML" class="tag">&#35; ML</a>
          
            <a href="/flexible-jekyll/tags#GMM" class="tag">&#35; GMM</a>
          
        </div>
      </div>
      <section class="comment-area">
  <div class="comment-wrapper">
    
    <div id="disqus_thread" class="article-comments"></div>
    <script>
      (function() {
          var d = document, s = d.createElement('script');
          s.src = '//ssrzz.disqus.com/embed.js';
          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    
  </div>
</section> <!-- End Comment Area -->

    </div> <!-- End Wrap Content -->
  </div> <!-- End Page Content -->
</article> <!-- End Article Page -->

</div>

  </div>
  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', '', 'auto');
  ga('send', 'pageview');
</script> <!-- End Analytics -->

</body>
</html>
